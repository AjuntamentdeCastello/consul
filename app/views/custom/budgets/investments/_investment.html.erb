<div id="<%= dom_id(investment) %>" class="budget-investment clear">
  <div class="panel <%= ('with-image' if feature?(:allow_images) && investment.image.present?) %>">

    <% if feature?(:allow_images) && investment.image.present? %>
    <div class="row" data-equalizer>

      <div class="small-12 medium-3 large-2 column text-center">
        <div data-equalizer-watch>
          <%= image_tag investment.image_url(:thumb),
                        alt: investment.image.title.unicode_normalize %>
        </div>
      </div>

      <div class="small-12 medium-6 large-7 column">
    <% else %>
      <div class="row">
        <div class="small-12 medium-9 column">
    <% end %>
        <div class="budget-investment-content">

          <% cache [locale_and_user_status(investment), 'index', investment, investment.author] do %>
            <h3><%= link_to investment.title, namespaced_budget_investment_path(investment) %></h3>


            <p class="investment-project-info">
              <%= l investment.created_at.to_date %>

              <% if investment.author.hidden? || investment.author.erased? %>
                <span class="bullet">&nbsp;&bull;&nbsp;</span>
                <span class="author">
                  <%= t("budgets.investments.show.author_deleted") %>
                </span>
              <% else %>
                <span class="bullet">&nbsp;&bull;&nbsp;</span>
                <span class="author">
                  <%= investment.author.name %>
                </span>
                <% if investment.respond_to?(:organization_name) && investment.organization_name.present? %>
                  <span class="label round is-association">
                    <%= t("shared.author_info.representa_a") %>
                  </span>
                  <span>
                    <%= "(#{investment.organization_name})" %>
                  </span>
                <% end %>
                <% if investment.author.official? %>
                  <span class="bullet">&nbsp;&bull;&nbsp;</span>
                  <span class="label round level-<%= investment.author.official_level %>">
                    <%= investment.author.official_position %>
                  </span>
                <% end %>
              <% end %>

              <span class="bullet">&nbsp;&bull;&nbsp;</span>
              <% if @budget.only_heading %>
                <%= investment.geozone.name %>
              <% else %>
                <%= investment.heading.name %>
              <% end %>
            </p>
            <div class="investment-project-description">
              <p><%= investment.description %></p>
              <div class="truncate"></div>
            </div>
            <% if @budget.areas && @area.nil? && investment.sub_area %>
              <h4>
                <%= investment.area.name %>
                <small><%= investment.sub_area.name %></small>
              </h4>
            <% end %>
            <% if @budget.areas %>
              <% if @area && !@sub_area && investment.sub_area %>
                <small><%= investment.sub_area.name %></small>
              <% else %>

              <% end %>
            <% end %>

            <%= render "shared/tags", taggable: investment, limit: 5 %>

          <% end %>
        </div>
      </div>

      <% unless investment.unfeasible? %>
        <% if investment.selected_by_assembly %>
          <div id="<%= dom_id(investment) %>_selected"
            class="small-12 medium-3 column text-center"
            <%= 'data-equalizer-watch' if feature?(:allow_images) && investment.image.present? %>>

            <div class="supports js-participation">
              <%= t("budgets.investments.investment.seleccionada_por_junta") %>
            </div>
          </div>
        <% else %>
          <% if investment.should_show_votes? %>
            <div id="<%= dom_id(investment) %>_votes"
                class="small-12 medium-3 column text-center"
                <%= 'data-equalizer-watch' if feature?(:allow_images) && investment.image.present? %>>
                <%= render partial: '/budgets/investments/votes', locals: {
                  investment: investment,
                  investment_votes: investment_votes,
                  vote_url: namespaced_budget_investment_vote_path(investment, value: 'yes')
                } %>
            </div>
          <% elsif investment.should_show_vote_count? %>
            <div id="<%= dom_id(investment) %>_votes"
                class="small-12 medium-3 column text-center"
                <%= 'data-equalizer-watch' if feature?(:allow_images) && investment.image.present? %>>
              <div class="supports js-participation">
                <span class="total-supports no-button">
                  <%= t("budgets.investments.investment.supports",
                      count: investment.total_votes) %>
                </span>
              </div>
            </div>
          <% end %>
        <% end %>

        <% if investment.should_show_ballots? %>
          <div id="<%= dom_id(investment) %>_ballot"
                class="small-12 medium-3 column text-center"
                <%= 'data-equalizer-watch' if feature?(:allow_images) && investment.image.present? %>>
                <%= render partial: '/budgets/investments/ballot', locals: {
                  investment: investment,
                  investment_ids: investment_ids,
                  ballot: ballot
                } %>
          </div>
        <% elsif investment.should_show_price? %>
          <div id="<%= dom_id(investment) %>_price"
               class="supports small-12 medium-3 column text-center"
               <%= 'data-equalizer-watch' if feature?(:allow_images) && investment.image.present? %>>
            <div class="supports">
              <span class="total-supports no-button">
                <%= investment.formatted_price %>
              </span>
            </div>
          </div>
        <% else %>
          <div <%= 'data-equalizer-watch' if feature?(:allow_images) && investment.image.present? %>></div>
        <% end %>

      <% end %>
    </div>
  </div>
</div>
